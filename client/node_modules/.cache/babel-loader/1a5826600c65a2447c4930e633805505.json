{"ast":null,"code":"import _slicedToArray from \"/Users/Teva/Desktop/Cleanup/Translator/whatson/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/Teva/Desktop/Cleanup/Translator/whatson/src/pages/MainPage/MainPage.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport Particles from 'react-particles-js';\nimport Header from '../../components/Header/Header';\nimport Interface from '../../components/Interface/Interface';\nimport Output from '../../components/Output/Output';\nimport LanguageToggle from '../../components/LanguageToggle/LanguageToggle';\nimport { ReactComponent as MicOff } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/microphone-off.svg\";\nimport { ReactComponent as MicOn } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/microphone-on.svg\";\nimport { MainPageContainer, MicContainer } from './MainPageStyles';\n\nfunction MainPage() {\n  //state\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        text = _useState2[0],\n        setText = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        translatedText = _useState4[0],\n        setTranslatedText = _useState4[1];\n\n  const _useState5 = useState('en-US'),\n        _useState6 = _slicedToArray(_useState5, 2),\n        inputLanguage = _useState6[0],\n        setInputLanguage = _useState6[1];\n\n  const _useState7 = useState('es'),\n        _useState8 = _slicedToArray(_useState7, 2),\n        outputLanguage = _useState8[0],\n        setOutputLanguage = _useState8[1];\n\n  const _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        isRecording = _useState10[0],\n        setIsRecording = _useState10[1];\n\n  const languages = {\n    \"en\": [\"English\", {\n      \"es\": \"Spanish\",\n      \"fr\": \"French\"\n    }],\n    \"fr\": [\"Français\", {\n      \"es\": \"Espagnol\",\n      \"en\": \"Anglais\"\n    }],\n    \"es\": [\"Español\", {\n      \"en\": \"Inglés\",\n      \"fr\": \"Francés\"\n    }]\n  };\n  const particlesOptions = {\n    particles: {\n      number: {\n        value: 50,\n        density: {\n          enable: true,\n          value_area: 800\n        }\n      },\n      size: {\n        value: 2\n      }\n    }\n  }; //fetch this\n\n  const inputLanguageHandler = (language, event) => {\n    event.preventDefault();\n\n    if (outputLanguage === language.slice(0, 2)) {\n      setOutputLanguage(inputLanguage.slice(0, 2));\n    }\n\n    setInputLanguage(language);\n  };\n\n  const outputLanguageHandler = (language, event) => {\n    event.preventDefault();\n\n    if (inputLanguage === language) {\n      switch (outputLanguage) {\n        case 'en':\n          setInputLanguage('en-US');\n          break;\n\n        case 'fr':\n          setInputLanguage('fr-FR');\n          break;\n\n        case 'es':\n          setInputLanguage('es-ES');\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    setOutputLanguage(language.slice(0, 2));\n  };\n\n  useEffect(() => {\n    const IAM_access_token = 'eyJraWQiOiIyMDE5MDcyNCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJpYW0tU2VydmljZUlkLTlkNWYzMWZkLTdjMDAtNGIyMS04MjdkLThlYmY4NDc4Mjk3NCIsImlkIjoiaWFtLVNlcnZpY2VJZC05ZDVmMzFmZC03YzAwLTRiMjEtODI3ZC04ZWJmODQ3ODI5NzQiLCJyZWFsbWlkIjoiaWFtIiwiaWRlbnRpZmllciI6IlNlcnZpY2VJZC05ZDVmMzFmZC03YzAwLTRiMjEtODI3ZC04ZWJmODQ3ODI5NzQiLCJzdWIiOiJTZXJ2aWNlSWQtOWQ1ZjMxZmQtN2MwMC00YjIxLTgyN2QtOGViZjg0NzgyOTc0Iiwic3ViX3R5cGUiOiJTZXJ2aWNlSWQiLCJ1bmlxdWVfaW5zdGFuY2VfY3JucyI6WyJjcm46djE6Ymx1ZW1peDpwdWJsaWM6c3BlZWNoLXRvLXRleHQ6dXMtc291dGg6YS84NGRhYzYxYWZmMDFkN2MyNGNmMmE5MzQ5ZGU0MDM5Yzo2MGJjOGFkZC1iNjIzLTQwZmItOWUyNy00Nzc0YTVhZTViYzI6OiJdLCJhY2NvdW50Ijp7InZhbGlkIjp0cnVlLCJic3MiOiI4NGRhYzYxYWZmMDFkN2MyNGNmMmE5MzQ5ZGU0MDM5YyJ9LCJpYXQiOjE1NzUzMjkyNTEsImV4cCI6MTU3NTMzMjg1MSwiaXNzIjoiaHR0cHM6Ly9pYW0uY2xvdWQuaWJtLmNvbS9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoiaWJtIG9wZW5pZCIsImNsaWVudF9pZCI6ImRlZmF1bHQiLCJhY3IiOjEsImFtciI6WyJwd2QiXX0.SZZnbXUYIppr1eGF1wStgrHSNwaoqGC363VzPR_okuMd3Q945dNnDveWotvUODSRsrPEve6kQJ-gP9dadIDyU_OymwJtSp3AAMVE3lOatUTZ-6ZV2_yfokX6RaylDsfI1erZf908A-GuzlX3S7TYwsHa0TAr_m6F_OnWNrIowDNqUnuX_1NIL8YFq1YxqKpnLC6XwAkpEVTkx0x1KPb6TXcR_RSUCytgpprDubuyseRjqD3yTj9Wb1xpxtEherakjVXwRz5fFJmkAy_niI_bRKyRKeQnLY9mgUdUgNxBT7WteFPtK5LTIQgIKYEwoDtjWC4Vu1OfWRe8D-wsrWyOIw';\n    const wsURI = \"wss://stream.watsonplatform.net/speech-to-text/api/v1/recognize?access_token=\".concat(IAM_access_token, \"&model=\").concat(inputLanguage, \"_BroadbandModel\");\n    const websocket = new WebSocket(wsURI);\n\n    websocket.onopen = function (event) {\n      onOpen(event);\n    };\n\n    websocket.onclose = function (event) {\n      onClose(event);\n    };\n\n    websocket.onmessage = function (event) {\n      onMessage(event);\n    };\n\n    websocket.onerror = function (event) {\n      onError(event);\n    };\n\n    function onOpen(event) {\n      console.log('connecting'); // console.log(websocket)\n    }\n\n    function onClose(event) {\n      console.log('closing:', event.data); // console.log(websocket)\n    }\n\n    function onMessage(event) {\n      const data = JSON.parse(event.data);\n\n      if (data.hasOwnProperty('results')) {\n        if (data.results.length) {\n          console.log(data);\n          fetch('http://localhost:3000/', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              data: data.results[0].alternatives[0].transcript,\n              outputLanguage,\n              inputLanguage\n            })\n          }).then(response => response.json()).then(response => {\n            setText(data.results[0].alternatives[0].transcript);\n            setTranslatedText(response);\n          });\n        }\n      }\n    }\n\n    function onError(event) {\n      console.log(event.data);\n    }\n\n    const listen = document.querySelector('.startRecording');\n    const stop = document.querySelector('.stopRecording');\n\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      console.log('getUserMedia supported.');\n      navigator.mediaDevices.getUserMedia( // constraints - only audio needed for this app\n      {\n        audio: true,\n        sampleSize: 16\n      }) // Success callback\n      .then(stream => {\n        const mediaRecorder = new MediaRecorder(stream);\n\n        listen.onclick = function (event) {\n          event.preventDefault();\n          console.log('inputLang:', inputLanguage);\n          console.log('outputLang:', outputLanguage);\n          console.log('uri:', wsURI);\n\n          if (websocket.readyState === 1 && mediaRecorder.state === 'inactive') {\n            setIsRecording(isRecording => !isRecording);\n            websocket.send(JSON.stringify({\n              action: 'start',\n              'content-type': 'application/octet-stream',\n              'interim_results': true // 'inactivity_timeout': -1\n\n            }));\n            mediaRecorder.start(1000);\n            console.log(mediaRecorder.state);\n            console.log(\"recorder started\");\n          }\n\n          stop.onclick = function (event) {\n            event.preventDefault();\n            setIsRecording(isRecording => !isRecording);\n\n            if (mediaRecorder.state === 'recording') {\n              mediaRecorder.stop();\n              console.log(mediaRecorder.state);\n              console.log(\"recorder stopped\");\n            }\n          };\n\n          mediaRecorder.ondataavailable = function (event) {\n            websocket.send(event.data);\n          };\n\n          mediaRecorder.onstop = function (event) {\n            websocket.send(JSON.stringify({\n              action: 'stop'\n            }));\n          };\n        };\n      }).catch(function (err) {\n        console.log('The following getUserMedia error occured: ' + err);\n      });\n    } else {\n      console.log('getUserMedia not supported on your browser!');\n    }\n  }, [inputLanguage]);\n  return React.createElement(MainPageContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, React.createElement(Particles, {\n    className: \"particles\",\n    params: particlesOptions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }), React.createElement(Header, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }), React.createElement(Interface, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, React.createElement(LanguageToggle, {\n    heading: inputLanguage === \"en-US\" ? \"From\" : \"De\",\n    handler: inputLanguageHandler,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }), React.createElement(MicContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(MicOff, {\n    style: isRecording ? {\n      width: '50%',\n      height: '50%'\n    } : {\n      display: \"none\"\n    },\n    className: \"stopRecording\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }), React.createElement(MicOn, {\n    style: isRecording ? {\n      display: \"none\"\n    } : {\n      width: '50%',\n      height: '50%'\n    },\n    className: \"startRecording\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  })), React.createElement(LanguageToggle, {\n    heading: inputLanguage === \"en-US\" ? \"To\" : \"A\",\n    handler: outputLanguageHandler,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  })), React.createElement(Output, {\n    originalLanguage: languages[inputLanguage.slice(0, 2)][0],\n    originalText: text,\n    translatedLanguage: languages[inputLanguage.slice(0, 2)][1][outputLanguage],\n    translatedText: translatedText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }));\n}\n\nexport default MainPage;","map":{"version":3,"sources":["/Users/Teva/Desktop/Cleanup/Translator/whatson/src/pages/MainPage/MainPage.jsx"],"names":["React","useState","useEffect","Particles","Header","Interface","Output","LanguageToggle","MainPageContainer","MicContainer","MainPage","text","setText","translatedText","setTranslatedText","inputLanguage","setInputLanguage","outputLanguage","setOutputLanguage","isRecording","setIsRecording","languages","particlesOptions","particles","number","value","density","enable","value_area","size","inputLanguageHandler","language","event","preventDefault","slice","outputLanguageHandler","IAM_access_token","wsURI","websocket","WebSocket","onopen","onOpen","onclose","onClose","onmessage","onMessage","onerror","onError","console","log","data","JSON","parse","hasOwnProperty","results","length","fetch","method","headers","body","stringify","alternatives","transcript","then","response","json","listen","document","querySelector","stop","navigator","mediaDevices","getUserMedia","audio","sampleSize","stream","mediaRecorder","MediaRecorder","onclick","readyState","state","send","action","start","ondataavailable","onstop","catch","err","width","height","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Particles from 'react-particles-js';\n\nimport Header from '../../components/Header/Header';\nimport Interface from '../../components/Interface/Interface';\nimport Output from '../../components/Output/Output';\nimport LanguageToggle from '../../components/LanguageToggle/LanguageToggle';\nimport { ReactComponent as MicOff} from '../../assets/microphone-off.svg';\nimport { ReactComponent as MicOn} from '../../assets/microphone-on.svg';\n\nimport {\n  MainPageContainer, MicContainer\n} from './MainPageStyles';\n\nfunction MainPage() {\n  //state\n  const [ text, setText ] = useState('');\n  const [ translatedText, setTranslatedText ] = useState('');\n  const [ inputLanguage, setInputLanguage ] = useState('en-US');\n  const [ outputLanguage, setOutputLanguage ] = useState('es');\n  const [ isRecording, setIsRecording ] = useState(false);\n\n\n  const languages = {\n    \"en\": [\"English\", {\"es\": \"Spanish\", \"fr\": \"French\"}],\n    \"fr\": [\"Français\", {\"es\": \"Espagnol\", \"en\": \"Anglais\"}],\n    \"es\": [\"Español\", {\"en\": \"Inglés\", \"fr\": \"Francés\"}]\n  }\n\n  const particlesOptions = {\n    particles: {\n      number: {\n        value: 50,\n        density: {\n          enable: true,\n          value_area: 800\n        }\n      },\n      size: {\n        value: 2\n      }\n    },\n  }\n\n  //fetch this\n\n\n  const inputLanguageHandler = (language, event) => {\n    event.preventDefault();\n    if (outputLanguage === language.slice(0, 2)) {\n      setOutputLanguage(inputLanguage.slice(0, 2))\n    }\n    setInputLanguage(language);\n  }\n  const outputLanguageHandler = (language, event) => {\n    event.preventDefault();\n    if (inputLanguage === language) {\n      switch (outputLanguage) {\n        case 'en':\n          setInputLanguage('en-US')\n          break;\n        case 'fr':\n          setInputLanguage('fr-FR')\n          break;\n        case 'es':\n          setInputLanguage('es-ES')\n          break;\n        default:\n          break;\n      }\n    }\n    setOutputLanguage(language.slice(0, 2));\n  }\n\n  useEffect(() => {\n    const IAM_access_token = 'eyJraWQiOiIyMDE5MDcyNCIsImFsZyI6IlJTMjU2In0.eyJpYW1faWQiOiJpYW0tU2VydmljZUlkLTlkNWYzMWZkLTdjMDAtNGIyMS04MjdkLThlYmY4NDc4Mjk3NCIsImlkIjoiaWFtLVNlcnZpY2VJZC05ZDVmMzFmZC03YzAwLTRiMjEtODI3ZC04ZWJmODQ3ODI5NzQiLCJyZWFsbWlkIjoiaWFtIiwiaWRlbnRpZmllciI6IlNlcnZpY2VJZC05ZDVmMzFmZC03YzAwLTRiMjEtODI3ZC04ZWJmODQ3ODI5NzQiLCJzdWIiOiJTZXJ2aWNlSWQtOWQ1ZjMxZmQtN2MwMC00YjIxLTgyN2QtOGViZjg0NzgyOTc0Iiwic3ViX3R5cGUiOiJTZXJ2aWNlSWQiLCJ1bmlxdWVfaW5zdGFuY2VfY3JucyI6WyJjcm46djE6Ymx1ZW1peDpwdWJsaWM6c3BlZWNoLXRvLXRleHQ6dXMtc291dGg6YS84NGRhYzYxYWZmMDFkN2MyNGNmMmE5MzQ5ZGU0MDM5Yzo2MGJjOGFkZC1iNjIzLTQwZmItOWUyNy00Nzc0YTVhZTViYzI6OiJdLCJhY2NvdW50Ijp7InZhbGlkIjp0cnVlLCJic3MiOiI4NGRhYzYxYWZmMDFkN2MyNGNmMmE5MzQ5ZGU0MDM5YyJ9LCJpYXQiOjE1NzUzMjkyNTEsImV4cCI6MTU3NTMzMjg1MSwiaXNzIjoiaHR0cHM6Ly9pYW0uY2xvdWQuaWJtLmNvbS9pZGVudGl0eSIsImdyYW50X3R5cGUiOiJ1cm46aWJtOnBhcmFtczpvYXV0aDpncmFudC10eXBlOmFwaWtleSIsInNjb3BlIjoiaWJtIG9wZW5pZCIsImNsaWVudF9pZCI6ImRlZmF1bHQiLCJhY3IiOjEsImFtciI6WyJwd2QiXX0.SZZnbXUYIppr1eGF1wStgrHSNwaoqGC363VzPR_okuMd3Q945dNnDveWotvUODSRsrPEve6kQJ-gP9dadIDyU_OymwJtSp3AAMVE3lOatUTZ-6ZV2_yfokX6RaylDsfI1erZf908A-GuzlX3S7TYwsHa0TAr_m6F_OnWNrIowDNqUnuX_1NIL8YFq1YxqKpnLC6XwAkpEVTkx0x1KPb6TXcR_RSUCytgpprDubuyseRjqD3yTj9Wb1xpxtEherakjVXwRz5fFJmkAy_niI_bRKyRKeQnLY9mgUdUgNxBT7WteFPtK5LTIQgIKYEwoDtjWC4Vu1OfWRe8D-wsrWyOIw'\n\n    const wsURI = `wss://stream.watsonplatform.net/speech-to-text/api/v1/recognize?access_token=${IAM_access_token}&model=${inputLanguage}_BroadbandModel`;\n\n    const websocket = new WebSocket(wsURI);\n    websocket.onopen = function(event) { onOpen(event) };\n    websocket.onclose = function(event) { onClose(event) };\n    websocket.onmessage = function(event) { onMessage(event) };\n    websocket.onerror = function(event) { onError(event) };\n\n    function onOpen(event) {\n      console.log('connecting')\n      // console.log(websocket)\n    }\n\n    function onClose(event) {\n      console.log('closing:', event.data);\n      // console.log(websocket)\n    }\n    \n    function onMessage(event) {\n      const data = JSON.parse(event.data);\n      if (data.hasOwnProperty('results')) {\n        if (data.results.length) {\n        console.log(data)\n        fetch('http://localhost:3000/', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            data: data.results[0].alternatives[0].transcript,\n            outputLanguage,\n            inputLanguage\n          })\n        }).then(response => response.json())\n        .then(response => {\n          setText(data.results[0].alternatives[0].transcript)\n          setTranslatedText(response)\n        })\n      }}\n    }\n    \n    function onError(event) {\n      console.log(event.data);\n    }\n\n    const listen = document.querySelector('.startRecording');\n    const stop = document.querySelector('.stopRecording');\n\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      console.log('getUserMedia supported.');\n      navigator.mediaDevices.getUserMedia (\n        // constraints - only audio needed for this app\n        { audio: true, sampleSize: 16 })\n  \n        // Success callback\n        .then(stream => {\n            const mediaRecorder = new MediaRecorder(stream);\n            listen.onclick = function(event) {\n              event.preventDefault();\n              \n              console.log('inputLang:', inputLanguage)\n              console.log('outputLang:', outputLanguage)\n              console.log('uri:', wsURI)\n              if (websocket.readyState === 1 && mediaRecorder.state === 'inactive') {\n                setIsRecording(isRecording => !isRecording)\n                websocket.send(JSON.stringify({\n                  action: 'start',\n                  'content-type': 'application/octet-stream',\n                  'interim_results': true,\n                  // 'inactivity_timeout': -1\n                }));\n                mediaRecorder.start(1000);\n                console.log(mediaRecorder.state);\n                console.log(\"recorder started\");\n              }\n\n              stop.onclick = function(event) {\n                event.preventDefault();\n                setIsRecording(isRecording => !isRecording);\n                if(mediaRecorder.state === 'recording') {\n                  mediaRecorder.stop();\n                  console.log(mediaRecorder.state);\n                  console.log(\"recorder stopped\");\n                }\n              }\n\n              mediaRecorder.ondataavailable = function(event) {\n                websocket.send(event.data)\n              }\n\n              mediaRecorder.onstop = function(event) {            \n                websocket.send(JSON.stringify({action: 'stop'}))\n              }\n        }})\n        .catch(function(err) {\n            console.log('The following getUserMedia error occured: ' + err);\n        }\n      );\n  } else {\n      console.log('getUserMedia not supported on your browser!');\n  }\n}, [inputLanguage])\n  \n  return (  \n    <MainPageContainer>\n      <Particles className='particles'\n        params={particlesOptions}\n      />\n      <Header />\n      <Interface >\n        <LanguageToggle heading={inputLanguage === \"en-US\"? \"From\" : \"De\"} handler={inputLanguageHandler} />\n        <MicContainer>\n          <MicOff style={isRecording ? {width: '50%', height: '50%'} : {display: \"none\"}} className=\"stopRecording\" />\n          <MicOn style={isRecording ? {display: \"none\"} : {width: '50%', height: '50%'} } className=\"startRecording\" />\n        </MicContainer>\n        <LanguageToggle heading={inputLanguage === \"en-US\"? \"To\" : \"A\"} handler={outputLanguageHandler}/>\n      </Interface>\n      <Output originalLanguage={languages[inputLanguage.slice(0, 2)][0]} originalText={text} translatedLanguage={languages[inputLanguage.slice(0, 2)][1][outputLanguage]} translatedText={translatedText}/>\n    </MainPageContainer>\n  )\n}\n\nexport default MainPage;"]},"metadata":{},"sourceType":"module"}